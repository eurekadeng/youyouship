# 校园快递代取互助平台——理小腿 接口文档

## 一、文档概述

### 1.1 文档目的

明确平台前后端交互接口规范，包括接口地址、请求参数、响应格式、业务逻辑说明，为前端开发、后端开发、测试提供统一依据，确保接口开发符合业务需求，保障系统顺畅联调。

### 1.2 适用范围

覆盖平台用户端（学生）、管理端（管理员）所有核心功能接口，包括注册登录、学生认证、订单管理、评价申诉、异常投诉、系统管理等模块。

### 1.3 基础规范

#### 1.3.1 通用请求头

| 参数名          | 类型     | 是否必传 | 说明                   |  
|--------------|--------|------|----------------------|  
| Content-Type | String | 是    | 固定为 application/json |  
| Token        | String | 是    | 登录成功后返回的身份令牌，用于权限校验  |  
#### 1.3.2 通用响应格式

所有接口响应数据格式统一，包含状态码、提示信息、业务数据：

```JSON
{
  "code": 200,
  "msg": "操作成功", 
  "data": {} 
}
```

#### 1.3.3 数据类型说明

- 字符串类型：String

- 整数类型：Integer（普通整数）、Long（大整数，如ID）

- 布尔类型：Boolean

- 小数类型：BigDecimal（金额等精度敏感数据）

- 日期类型：String（固定格式：yyyy-MM-dd HH:mm:ss）

- 数组类型：Array

- 对象类型：Object

#### 1.3.4 权限说明

- 未认证用户：仅可访问注册、登录、认证申请接口

- 已认证用户：可访问订单发布、接单、评价等用户端核心接口

- 管理员：可访问所有管理端接口（认证审核、订单管理、用户管理等）

#### 1.3.5 接口调用规范

- 超时时间：所有接口调用超时时间统一为3秒，超时需重新发起请求

- 调用频率限制：普通用户单接口每分钟最多调用60次，管理员接口无频率限制，超出频率返回`{"code":429,"msg":"请求过于频繁，请稍后重试","data":null}`

- 文件上传要求：仅支持jpg/png格式，单文件大小≤5MB，多文件上传最多不超过3个

## 二、全局数据字典

### 2.1 认证状态枚举

| 状态值 | 状态名称 | 说明             |
|-----|------|----------------|
| 0   | 未认证  | 用户未提交认证申请      |
| 1   | 待审核  | 用户已提交申请，管理员未处理 |
| 2   | 已认证  | 管理员审核通过，解锁全部权限 |
| 3   | 已驳回  | 管理员审核驳回，需重新提交  |
### 2.2 订单状态枚举

| 状态值 | 状态名称  | 说明             |
|-----|-------|----------------|
| 0   | 待接单   | 订单发布后未被承接      |
| 1   | 已接单   | 接单者确认承接订单      |
| 2   | 配送中   | 接单者已取件，正在配送    |
| 3   | 已完成   | 发单者核销验证码，订单完成  |
| 4   | 已取消   | 订单未完成前被取消      |
| 5   | 纠纷处理中 | 订单存在异常，管理员介入处理 |
### 2.3 投诉类型枚举

| 类型值 | 类型名称  | 说明            |
|-----|-------|---------------|
| 0   | 物品破损  | 配送物品出现破损      |
| 1   | 物品丢失  | 配送物品丢失        |
| 2   | 未按时配送 | 未在订单截止时间前完成配送 |
| 3   | 其他    | 其他异常情况        |
### 2.4 地址标签状态枚举

| 状态值 | 状态名称 | 说明             |
|-----|------|----------------|
| 0   | 无效   | 标签已停用，不可用于订单发布 |
| 1   | 有效   | 标签正常可用         |
### 2.5 用户类型枚举（订单相关）

| 类型值 | 类型名称 | 说明      |
|-----|------|---------|
| 1   | 发单者  | 发布订单的用户 |
| 2   | 接单者  | 承接订单的用户 |
## 三、注册登录模块接口

### 3.1 用户注册

#### 接口地址

`POST /api/user/register`

#### 请求参数

| 参数名      | 类型     | 是否必传 | 长度限制 | 说明              |
|----------|--------|------|------|-----------------|
| account  | String | 是    | 1-50 | 登录账号（唯一）        |
| password | String | 是    | 6-20 | 登录密码（明文，后端加密存储） |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "注册成功",
  "data": {
    "id": 1001,
    "account": "student001",
    "authStatus": 0,
    "role": "USER"
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "账号已存在",
  "data": null
}
```

```JSON
{
  "code": 400,
  "msg": "密码长度必须在6-20位之间",
  "data": null
}
```

### 3.2 用户登录

#### 接口地址

`POST /api/user/login`

#### 请求参数

| 参数名      | 类型     | 是否必传 | 说明       |
|----------|--------|------|----------|
| account  | String | 是    | 登录账号     |
| password | String | 是    | 登录密码（明文） |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "登录成功",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "userInfo": {
      "id": 1001,
      "account": "student001",
      "phone": "13800138001",
      "authStatus": 2,
      "role": "USER",
      "avatar": "/avatar/student001.jpg"
    }
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "账号或密码错误",
  "data": null
}
```

```JSON
{
  "code": 400,
  "msg": "账号已被禁用",
  "data": null
}
```

### 3.3 忘记密码（重置密码）

#### 接口地址

`POST /api/user/resetPassword`

#### 请求参数

| 参数名         | 类型     | 是否必传 | 说明         |
|-------------|--------|------|------------|
| account     | String | 是    | 登录账号       |
| newPassword | String | 是    | 新密码（6-20位） |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "密码重置成功",
  "data": null
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "账号不存在",
  "data": null
}
```

```JSON
{
  "code": 400,
  "msg": "新密码长度不符合要求",
  "data": null
}
```

## 四、学生认证模块接口

### 4.1 提交认证申请

#### 接口地址

`POST /api/auth/submit`

#### 权限要求

未认证/已驳回用户

#### 请求参数

| 参数名       | 类型     | 是否必传 | 说明                                  |
|-----------|--------|------|-------------------------------------|
| Name      | String | 是    | 姓名                                  |
| studentId | String | 是    | 学号（符合校园规则）                          |
| college   | String | 是    | 所属学院                                |
| grade     | String | 是    | 年级（如2023级）                          |
| idCard    | String | 是    | 学生证/校园卡照片Base64编码（格式jpg/png，大小≤5MB） |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "认证申请提交成功，等待审核",
  "data": {
    "authId": 2001,
    "userId": 1001,
    "authStatus": 1,
    "createTime": "2025-01-20 14:30:00"
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "学号格式不正确",
  "data": null
}
```

```JSON
{
  "code": 400,
  "msg": "照片格式仅支持jpg/png，且大小不超过5MB",
  "data": null
}
```

### 4.2 管理员审核认证

#### 接口地址

`POST /api/auth/audit`

#### 权限要求

管理员

#### 请求参数

| 参数名         | 类型      | 是否必传 | 说明               |
|-------------|---------|------|------------------|
| authId      | Long    | 是    | 认证记录ID           |
| auditResult | Integer | 是    | 审核结果：1-通过，2-驳回   |
| auditRemark | String  | 否    | 驳回原因（审核结果为驳回时必传） |
| auditorId   | Long    | 是    | 审核管理员ID          |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "审核完成",
  "data": {
    "authId": 2001,
    "userId": 1001,
    "authStatus": 2,
    "auditTime": "2025-01-20 15:30:00",
    "auditRemark": "认证通过"
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "认证记录不存在",
  "data": null
}
```

```JSON
{
  "code": 400,
  "msg": "驳回审核必须填写驳回原因",
  "data": null
}
```

### 4.3 查询认证状态

#### 接口地址

`GET /api/auth/queryStatus`

#### 权限要求

已登录用户

#### 请求参数

| 参数名    | 类型   | 是否必传 | 说明                  |
|--------|------|------|---------------------|
| userId | Long | 是    | 用户ID（从Token中解析，可省略） |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "查询成功",
  "data": {
    "authStatus": 2,
    "statusDesc": "已认证",
    "auditRemark": null,
    "createTime": "2025-01-20 14:30:00",
    "auditTime": "2025-01-20 15:30:00"
  }
}
```

#### 异常响应

```JSON
{
  "code": 401,
  "msg": "未登录，无法查询",
  "data": null
}
```

### 4.4 管理员查询认证列表

#### 接口地址

`GET /api/auth/admin/queryList`

#### 权限要求

管理员

#### 请求参数

| 参数名         | 类型      | 是否必传 | 说明                                   |
|-------------|---------|------|--------------------------------------|
| auditStatus | Integer | 否    | 审核状态：0-未认证，1-待审核，2-已认证，3-已驳回（不传查询全部） |
| pageNum     | Integer | 是    | 页码（默认1）                              |
| pageSize    | Integer | 是    | 每页条数（默认10）                           |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "查询成功",
  "data": {
    "total": 20,
    "list": [
      {
        "authId": 2001,
        "userId": 1001,
        "studentId": "2023001001",
        "college": "计算机学院",
        "grade": "2023级",
        "idCard": "/auth/2023001001.jpg",
        "authStatus": 1,
        "createTime": "2025-01-20 14:30:00"
      }
    ],
    "pageNum": 1,
    "pageSize": 10,
    "pages": 2
  }
}
```

#### 异常响应

```JSON
{
  "code": 403,
  "msg": "无管理员权限，禁止访问",
  "data": null
}
```

```JSON
{
  "code": 400,
  "msg": "页码必须为正整数",
  "data": null
}
```


## 五、订单模块接口

### 5.1 发布订单

#### 接口地址

`POST /api/order/publish`

#### 权限要求

已认证用户

#### 请求参数

| 参数名                  | 类型         | 是否必传 | 说明                             |
|----------------------|------------|------|--------------------------------|
| orderTitle           | String     | 是    | 订单标题（1-100字）                   |
| orderDesc            | String     | 否    | 订单需求描述                         |
| rewardAmount         | BigDecimal | 是    | 酬金金额（单位：元）                     |
| pickupTagId          | Long       | 是    | 取件地址标签ID（关联address_tag表）       |
| pickupDetailAddress  | String     | 是    | 取件详细地址（1-255字）                 |
| receiveTagId         | Long       | 是    | 收货地址标签ID（关联address_tag表）       |
| receiveDetailAddress | String     | 是    | 收货详细地址（1-255字）                 |
| expressPickupCode    | String     | 否    | 快递取件码              |
| deadlineTime         | String     | 是    | 订单截止时间（格式：yyyy-MM-dd HH:mm:ss） |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "订单发布成功",
  "data": {
    "orderId": 3001,
    "orderNo": "2025012012345678",
    "orderStatus": 0,
    "createTime": "2025-01-20 16:00:00"
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "订单标题不能为空",
  "data": null
}
```

```JSON
{
  "code": 400,
  "msg": "截止时间格式错误，正确格式为yyyy-MM-dd HH:mm:ss",
  "data": null
}
```

### 5.2 接单

#### 接口地址

`POST /api/order/receive`

#### 权限要求

已认证用户

#### 请求参数

| 参数名     | 类型   | 是否必传 | 说明                   |
|---------|------|------|----------------------|
| orderId | Long | 是    | 订单ID                 |
| userId  | Long | 是    | 接单者ID（从Token中解析，可省略） |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "接单成功",
  "data": {
    "orderId": 3001,
    "orderNo": "2025012012345678",
    "orderStatus": 1,
    "receiverId": 1002,
    "updateTime": "2025-01-20 16:30:00"
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "该订单已被接单",
  "data": null
}
```

```JSON
{
  "code": 400,
  "msg": "订单不存在或已取消",
  "data": null
}
```

### 5.3 取消订单

#### 接口地址

`POST /api/order/cancel`

#### 权限要求

已认证用户（发单者/接单者）

#### 请求参数

| 参数名          | 类型      | 是否必传 | 说明                                       |
|--------------|---------|------|------------------------------------------|
| orderId      | Long    | 是    | 订单ID                                     |
| cancelReason | String  | 否    | 取消原因（1-255字）                             |
| userType     | Integer | 是    | 用户类型：1-发单者（订单截止时间前可取消），2-接单者（接单后1小时内可取消） |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "订单取消成功",
  "data": {
    "orderId": 3001,
    "orderStatus": 4,
    "cancelReason": "自己已取件",
    "updateTime": "2025-01-20 16:45:00"
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "超过取消时限，无法自行取消",
  "data": null
}
```

```JSON
{
  "code": 400,
  "msg": "订单已完成，不可取消",
  "data": null
}
```

### 5.4 上传取件照片

#### 接口地址

`POST /api/order/uploadPickupPhoto`

#### 权限要求

已认证用户（接单者）

#### 请求参数

| 参数名          | 类型    | 是否必传 | 说明                                    |
|--------------|-------|------|---------------------------------------|
| orderId      | Long  | 是    | 订单ID                                  |
| pickupPhotos | Array | 是    | 取件照片Base64编码数组（最多2张，格式jpg/png，单张≤5MB） |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "照片上传成功",
  "data": {
    "pickupPhotos": "/order/photo1.jpg,/order/photo2.jpg",
    "updateTime": "2025-01-20 17:00:00"
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "最多只能上传2张照片",
  "data": null
}
```

```JSON
{
  "code": 400,
  "msg": "照片格式仅支持jpg/png，且单张大小不超过5MB",
  "data": null
}
```

### 5.5 开始配送

#### 接口地址

`POST /api/order/startDelivery`

#### 权限要求

已认证用户（接单者）

#### 请求参数

| 参数名     | 类型   | 是否必传 | 说明   |
|---------|------|------|------|
| orderId | Long | 是    | 订单ID |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "配送开始",
  "data": {
    "orderId": 3001,
    "orderStatus": 2,
    "updateTime": "2025-01-20 17:10:00"
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "未上传取件照片，无法开始配送",
  "data": null
}
```

### 5.6 生成配送验证码

#### 接口地址

`POST /api/order/generateCode`

#### 权限要求

已认证用户（接单者）

#### 请求参数

| 参数名     | 类型   | 是否必传 | 说明   |
|---------|------|------|------|
| orderId | Long | 是    | 订单ID |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "验证码生成成功",
  "data": {
    "verificationCode": "887766",
    "codeExpireTime": "2025-01-20 17:25:00"
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "订单未处于配送中状态，无法生成验证码",
  "data": null
}
```

### 5.7 核销验证码（确认完成）

#### 接口地址

`POST /api/order/verifyCode`

#### 权限要求

已认证用户（发单者）

#### 请求参数

| 参数名              | 类型     | 是否必传 | 说明    |
|------------------|--------|------|-------|
| orderId          | Long   | 是    | 订单ID  |
| verificationCode | String | 是    | 配送验证码 |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "订单完成",
  "data": {
    "orderId": 3001,
    "orderStatus": 3,
    "finishTime": "2025-01-20 17:20:00",
    "updateTime": "2025-01-20 17:20:00"
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "验证码错误或已过期",
  "data": null
}
```

```JSON
{
  "code": 400,
  "msg": "订单未处于配送中状态，无法核销验证码",
  "data": null
}
```

### 5.8 查询订单列表

#### 接口地址

`GET /api/order/queryList`

#### 权限要求

已认证用户

#### 请求参数

| 参数名          | 类型      | 是否必传 | 说明             |
|--------------|---------|------|----------------|
| userType     | Integer | 是    | 1-发单者，2-接单者    |
| orderStatus  | Integer | 否    | 订单状态（不传查询全部）   |
| pickupTagId  | Long    | 否    | 取件地址标签ID（筛选条件） |
| receiveTagId | Long    | 否    | 收货地址标签ID（筛选条件） |
| pageNum      | Integer | 是    | 页码（默认1）        |
| pageSize     | Integer | 是    | 每页条数（默认10）     |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "查询成功",
  "data": {
    "total": 15,
    "list": [
      {
        "orderId": 3001,
        "orderNo": "2025012012345678",
        "orderTitle": "取快递到教学楼",
        "rewardAmount": 5.00,
        "pickupTagName": "北苑快递站",
        "pickupDetailAddress": "北苑快递站A区",
        "receiveTagName": "第一教学楼",
        "receiveDetailAddress": "第一教学楼302室",
        "orderStatus": 3,
        "statusDesc": "已完成",
        "createTime": "2025-01-20 16:00:00",
        "finishTime": "2025-01-20 17:20:00"
      }
    ],
    "pageNum": 1,
    "pageSize": 10,
    "pages": 2
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "用户类型参数必填（1-发单者，2-接单者）",
  "data": null
}
```


### 5.9 获取订单详情

#### 接口地址

`GET /api/order/detail`

#### 权限要求

已认证用户（仅发单者、接单者、管理员可查看完整信息）

#### 请求参数

| 参数名     | 类型   | 是否必传 | 说明   |
|---------|------|------|------|
| orderId | Long | 是    | 订单ID |
#### 响应示例（发单者/接单者视角）

```JSON
{
  "code": 200,
  "msg": "查询成功",
  "data": {
    "orderId": 3001,
    "orderNo": "2025121512345678",
    "senderId": 1001,
    "receiverId": 1002,
    "orderTitle": "代取中通快递",
    "orderDesc": "请帮我取北苑宿舍楼下的中通快递",
    "rewardAmount": 5.00,
    "detailAddress": "北苑3号楼402室",
    "deadlineTime": "2025-12-15 18:00:00",
    "orderStatus": 2,
    "expressPickupCode": "682351",  
    "pickupPhotos": "/pickup/3001_1.jpg,/pickup/3001_2.jpg",
    "verificationCode": "A1B2C3",  
    "codeExpireTime": "2025-12-15 19:00:00",
    "createTime": "2025-12-15 16:00:00",
    "updateTime": "2025-12-15 16:30:00"
  }
}
```


#### 响应示例（其他用户视角）

```JSON
{
  "code": 200,
  "msg": "查询成功",
  "data": {
    "orderId": 3001,
    "orderNo": "2025121512345678",
    "senderId": 1001,
    "receiverId": 1002,
    "orderTitle": "代取中通快递",
    "orderDesc": "请帮我取北苑宿舍楼下的中通快递",
    "rewardAmount": 5.00,
    "detailAddress": "北苑3号楼402室",
    "deadlineTime": "2025-12-15 18:00:00",
    "orderStatus": 2,
    "expressPickupCode": null,     
    "pickupPhotos": null,
    "verificationCode": null,
    "codeExpireTime": null,
    "createTime": "2025-12-15 16:00:00",
    "updateTime": "2025-12-15 16:30:00"
  }
}
```

---


### 5.10 修改订单信息

#### 接口地址

`POST /api/order/edit`

#### 权限要求

已认证用户（仅发单者可修改）

#### 请求参数

| 参数名                  | 类型         | 是否必传 | 说明                           |
|----------------------|------------|------|------------------------------|
| orderId              | Long       | 是    | 订单ID                         |
| orderTitle           | String     | 否    | 订单标题                         |
| orderDesc            | String     | 否    | 订单描述                         |
| rewardAmount         | BigDecimal | 否    | 酬金金额                         |
| pickupTagId          | Long       | 否    | 取件地址标签ID                     |
| pickupDetailAddress  | String     | 否    | 取件详细地址                       |
| receiveTagId         | Long       | 否    | 收货地址标签ID                     |
| receiveDetailAddress | String     | 否    | 收货详细地址                       |
| deadlineTime         | String     | 否    | 截止时间（格式：yyyy-MM-dd HH:mm:ss） |
| expressPickupCode    | String     | 否    | 快递取件码（仅发单者可修改）               |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "订单修改成功",
  "data": {
    "orderId": 3001,
    "orderNo": "2025121512345678",
    "orderTitle": "代取中通快递（北苑楼下）",
    "orderDesc": "请帮我取北苑宿舍楼下的中通快递，记得带取件码",
    "rewardAmount": 6.00,
    "pickupTagId": 2,
    "pickupDetailAddress": "北苑快递站A区",
    "receiveTagId": 1,
    "receiveDetailAddress": "第一教学楼302室",
    "deadlineTime": "2025-12-15 19:00:00",
    "expressPickupCode": "682351",
    "updateTime": "2025-12-15 17:10:00"
  }
}
```

#### 错误响应示例

```JSON
{
  "code": 602,
  "msg": "权限不足，仅发单者可修改订单",
  "data": null
}
```

---

## 六、评价与申诉模块接口

### 6.1 提交评价

#### 接口地址

`POST /api/evaluation/submit`

#### 权限要求

已认证用户（发单者）

#### 请求参数

| 参数名         | 类型      | 是否必传 | 说明         |
|-------------|---------|------|------------|
| orderId     | Long    | 是    | 订单ID（已完成）  |
| starLevel   | Integer | 是    | 星级评分（1-5星） |
| evalContent | String  | 否    | 评价内容       |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "评价提交成功",
  "data": {
    "evalId": 4001,
    "orderId": 3001,
    "starLevel": 5,
    "createTime": "2025-01-20 17:30:00"
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "订单未完成，无法提交评价",
  "data": null
}
```

```JSON
{
  "code": 400,
  "msg": "星级评分必须在1-5星之间",
  "data": null
}
```

### 6.2 查询订单评价

#### 接口地址

`GET /api/evaluation/queryByOrderId`

#### 权限要求

已认证用户（订单相关方）/管理员

#### 请求参数

| 参数名     | 类型   | 是否必传 | 说明   |
|---------|------|------|------|
| orderId | Long | 是    | 订单ID |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "查询成功",
  "data": {
    "evalId": 4001,
    "orderId": 3001,
    "senderId": 1001,
    "senderAccount": "student001",
    "receiverId": 1002,
    "receiverAccount": "student002",
    "starLevel": 5,
    "evalContent": "接单很快，送的也及时",
    "isComplaint": 0,
    "createTime": "2025-01-20 17:30:00"
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "该订单暂无评价",
  "data": null
}
```

### 6.3 提交评价申诉

#### 接口地址

`POST /api/appeal/submit`

#### 权限要求

已认证用户（被评价者）

#### 请求参数

| 参数名            | 类型     | 是否必传 | 说明                   |
|----------------|--------|------|----------------------|
| evalId         | Long   | 是    | 评价ID                 |
| appealReason   | String | 是    | 申诉理由                 |
| appealEvidence | Array  | 否    | 申诉凭证照片Base64数组（最多3张） |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "申诉提交成功",
  "data": {
    "appealId": 5001,
    "evalId": 4001,
    "appealStatus": 0,
    "createTime": "2025-01-20 18:00:00"
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "评价ID不存在",
  "data": null
}
```

```JSON
{
  "code": 400,
  "msg": "申诉理由不能为空",
  "data": null
}
```

### 6.4 管理员处理申诉

#### 接口地址

`POST /api/appeal/handle`

#### 权限要求

管理员

#### 请求参数

| 参数名          | 类型      | 是否必传 | 说明                 |
|--------------|---------|------|--------------------|
| appealId     | Long    | 是    | 申诉ID               |
| appealResult | Integer | 是    | 处理结果：2-申诉通过，3-申诉驳回 |
| handleRemark | String  | 否    | 处理备注               |
| handlerId    | Long    | 是    | 处理管理员ID            |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "申诉处理完成",
  "data": {
    "appealId": 5001,
    "appealStatus": 2,
    "handleRemark": "申诉有效，已删除评价",
    "handleTime": "2025-01-20 19:00:00"
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "申诉记录不存在",
  "data": null
}
```

```JSON
{
  "code": 403,
  "msg": "无管理员权限，禁止操作",
  "data": null
}
```

## 七、异常投诉模块接口

### 7.1 提交投诉

#### 接口地址

`POST /api/complaint/submit`

#### 权限要求

已认证用户（订单相关方）

#### 请求参数

| 参数名              | 类型      | 是否必传 | 说明                              |
|------------------|---------|------|---------------------------------|
| orderId          | Long    | 是    | 订单ID                            |
| complainantId    | Long    | 是    | 投诉人ID（从Token中解析）                |
| defendantId      | Long    | 是    | 被投诉人ID                          |
| complaintType    | Integer | 是    | 投诉类型：0-物品破损，1-物品丢失，2-未按时配送，3-其他 |
| complaintContent | String  | 是    | 投诉内容                            |
| evidencePhotos   | Array   | 否    | 投诉凭证照片Base64数组（最多3张）            |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "投诉提交成功",
  "data": {
    "complaintId": 6001,
    "orderId": 3001,
    "complaintStatus": 0,
    "createTime": "2025-01-20 17:40:00"
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "投诉内容不能为空",
  "data": null
}
```

```JSON
{
  "code": 400,
  "msg": "投诉类型参数错误（0-物品破损，1-物品丢失，2-未按时配送，3-其他）",
  "data": null
}
```

### 7.2 管理员处理投诉

#### 接口地址

`POST /api/complaint/handle`

#### 权限要求

管理员

#### 请求参数

| 参数名             | 类型      | 是否必传 | 说明               |
|-----------------|---------|------|------------------|
| complaintId     | Long    | 是    | 投诉ID             |
| complaintResult | Integer | 是    | 处理结果：2-已解决，3-已驳回 |
| handleRemark    | String  | 否    | 处理备注             |
| handlerId       | Long    | 是    | 处理管理员ID          |
| orderStatus     | Integer | 否    | 订单状态（纠纷处理时修改）    |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "投诉处理完成",
  "data": {
    "complaintId": 6001,
    "complaintStatus": 2,
    "handleRemark": "双方协商一致，投诉已解决",
    "handleTime": "2025-01-20 18:30:00",
    "orderStatus": 3
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "投诉记录不存在",
  "data": null
}
```

```JSON
{
  "code": 403,
  "msg": "无管理员权限，禁止操作",
  "data": null
}
```

### 7.3 管理员查询投诉列表

#### 接口地址

`GET /api/complaint/admin/queryList`

#### 权限要求

管理员

#### 请求参数

| 参数名             | 类型      | 是否必传 | 说明                           |
|-----------------|---------|------|------------------------------|
| complaintStatus | Integer | 否    | 投诉状态：0-待处理，1-处理中，2-已解决，3-已驳回 |
| startTime       | String  | 否    | 开始时间（格式：yyyy-MM-dd HH:mm:ss） |
| endTime         | String  | 否    | 结束时间（格式：yyyy-MM-dd HH:mm:ss） |
| pageNum         | Integer | 是    | 页码（默认1）                      |
| pageSize        | Integer | 是    | 每页条数（默认10）                   |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "查询成功",
  "data": {
    "total": 8,
    "list": [
      {
        "complaintId": 6001,
        "orderId": 3001,
        "complainantAccount": "student001",
        "defendantAccount": "student002",
        "complaintType": 2,
        "complaintTypeDesc": "未按时配送",
        "complaintStatus": 0,
        "statusDesc": "待处理",
        "createTime": "2025-01-20 17:40:00"
      }
    ],
    "pageNum": 1,
    "pageSize": 10,
    "pages": 1
  }
}
```

#### 异常响应

```JSON
{
  "code": 403,
  "msg": "无管理员权限，禁止访问",
  "data": null
}
```


## 八、系统管理模块接口

### 8.1 管理员查询用户列表

#### 接口地址

`GET /api/admin/user/queryList`

#### 权限要求

管理员

#### 请求参数

| 参数名        | 类型      | 是否必传 | 说明              |
|------------|---------|------|-----------------|
| authStatus | Integer | 否    | 认证状态（不传查询全部）    |
| isDisabled | Integer | 否    | 账号状态：0-正常，1-已禁用 |
| account    | String  | 否    | 登录账号（筛选条件）      |
| pageNum    | Integer | 是    | 页码（默认1）         |
| pageSize   | Integer | 是    | 每页条数（默认10）      |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "查询成功",
  "data": {
    "total": 100,
    "list": [
      {
        "id": 1001,
        "account": "student001",
        "phone": "13800138001",
        "authStatus": 2,
        "authStatusDesc": "已认证",
        "isDisabled": 0,
        "role": "USER",
        "createTime": "2025-01-19 10:00:00"
      }
    ],
    "pageNum": 1,
    "pageSize": 10,
    "pages": 10
  }
}
```

#### 异常响应

```JSON
{
  "code": 403,
  "msg": "无管理员权限，禁止访问",
  "data": null
}
```

```JSON
{
  "code": 403,
  "msg": "无管理员权限，禁止访问",
  "data": null
}
```

### 8.2 管理员禁用/启用用户账号

#### 接口地址

`POST /api/admin/user/changeStatus`

#### 权限要求

管理员

#### 请求参数

| 参数名        | 类型      | 是否必传 | 说明             |
|------------|---------|------|----------------|
| userId     | Long    | 是    | 用户ID           |
| isDisabled | Integer | 是    | 账号状态：0-启用，1-禁用 |
| remark     | String  | 否    | 操作备注（如违规原因）    |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "账号状态修改成功",
  "data": {
    "userId": 1001,
    "isDisabled": 1,
    "remark": "恶意投诉，禁用账号7天"
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "用户ID不存在",
  "data": null
}
```

```JSON
{
  "code": 403,
  "msg": "无管理员权限，禁止操作",
  "data": null
}
```

### 8.3 查询地址标签列表

#### 接口地址

`GET /api/addressTag/queryList`

#### 权限要求

所有已登录用户

#### 请求参数

| 参数名     | 类型      | 是否必传 | 说明                     |
|---------|---------|------|------------------------|
| isValid | Integer | 否    | 标签状态：0-无效，1-有效（不传查询全部） |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "查询成功",
  "data": [
    {
      "tagId": 1,
      "tagName": "第一教学楼",
      "tagDesc": "主校区1教（计算机学院旁）",
      "isValid": 1
    },
    {
      "tagId": 5,
      "tagName": "图书馆",
      "tagDesc": "校图书馆（主校区中心）",
      "isValid": 0
    }
  ]
}
```

#### 异常响应

```JSON
{
  "code": 401,
  "msg": "未登录，无法查询",
  "data": null
}
```

```JSON
{
  "code": 400,
  "msg": "标签状态参数错误（0-无效，1-有效）",
  "data": null
}
```

### 8.4 管理员新增/修改地址标签

#### 接口地址

`POST /api/admin/addressTag/saveOrUpdate`

#### 权限要求

管理员

#### 请求参数

| 参数名     | 类型      | 是否必传 | 说明              |
|---------|---------|------|-----------------|
| tagId   | Long    | 否    | 标签ID（新增不传，修改必传） |
| tagName | String  | 是    | 标签名称（唯一）        |
| tagDesc | String  | 否    | 标签描述            |
| isValid | Integer | 是    | 标签状态：0-无效，1-有效  |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "操作成功",
  "data": {
    "tagId": 6,
    "tagName": "第三食堂",
    "tagDesc": "主校区三食堂（北苑宿舍旁）",
    "isValid": 1
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "标签名称已存在",
  "data": null
}
```

```JSON
{
  "code": 400,
  "msg": "修改标签必须传入标签ID",
  "data": null
}
```

```JSON
{
  "code": 403,
  "msg": "无管理员权限，禁止操作",
  "data": null
}
```

### 8.5 管理员查询所有订单

#### 接口地址

`GET /api/order/admin/queryAll`

#### 权限要求

管理员

#### 请求参数

| 参数名         | 类型      | 是否必传 | 说明                           |
|-------------|---------|------|------------------------------|
| orderStatus | Integer | 否    | 订单状态（不传查询全部）                 |
| startTime   | String  | 否    | 开始时间（格式：yyyy-MM-dd HH:mm:ss） |
| endTime     | String  | 否    | 结束时间（格式：yyyy-MM-dd HH:mm:ss） |
| account     | String  | 否    | 用户名/管理员账号（筛选条件）              |
| pageNum     | Integer | 是    | 页码（默认1）                      |
| pageSize    | Integer | 是    | 每页条数（默认10）                   |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "查询成功",
  "data": {
    "total": 50,
    "list": [
      {
        "orderId": 3001,
        "orderNo": "2025012012345678",
        "orderTitle": "取快递到教学楼",
        "rewardAmount": 5.00,
        "pickupTagName": "北苑快递站",
        "receiveTagName": "第一教学楼",
        "orderStatus": 3,
        "statusDesc": "已完成",
        "senderAccount": "student001",
        "receiverAccount": "student002",
        "createTime": "2025-01-20 16:00:00",
        "finishTime": "2025-01-20 17:20:00"
      }
    ],
    "pageNum": 1,
    "pageSize": 10,
    "pages": 5
  }
}
```

#### 异常响应

```JSON
{
  "code": 403,
  "msg": "无管理员权限，禁止访问",
  "data": null
}
```

```JSON
{
  "code": 400,
  "msg": "开始时间格式错误，正确格式为yyyy-MM-dd HH:mm:ss",
  "data": null
}
```

## 九 、通用接口

### 9.1 上传文件（通用）

#### 接口地址

`POST /api/common/upload`

#### 权限要求

已登录用户

#### 请求参数

| 参数名      | 类型     | 是否必传 | 说明                                       |
|----------|--------|------|------------------------------------------|
| file     | File   | 是    | 文件（格式jpg/png，大小≤5MB）                     |
| fileType | String | 是    | 文件类型：auth-认证照片，order-订单照片，complaint-投诉凭证 |
#### 响应示例

```JSON
{
  "code": 200,
  "msg": "文件上传成功",
  "data": {
    "filePath": "/upload/auth/20250120/xxx.jpg"
  }
}
```

#### 异常响应

```JSON
{
  "code": 400,
  "msg": "文件格式仅支持jpg/png",
  "data": null
}
```

```JSON
{
  "code": 400,
  "msg": "文件大小超过5MB限制",
  "data": null
}
```

### 9.2 获取用户信息（当前登录用户）

#### 接口地址

`GET /api/common/getCurrentUser`

#### 权限要求

已登录用户

#### 请求参数

无

#### 响应示例

```JSON
{
  "code": 200,
  "msg": "查询成功",
  "data": {
    "id": 1001,
    "account": "student001",
    "phone": "13800138001",
    "avatar": "/avatar/student001.jpg",
    "authStatus": 2,
    "role": "USER",
    "college": "计算机学院",
    "grade": "2023级"
  }
}
```

#### 异常响应

```JSON
{
  "code": 401,
  "msg": "未登录，无法获取用户信息",
  "data": null
}
```

